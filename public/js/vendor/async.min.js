!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={},u=function(){};t="object"==typeof window&&this===window?window:"object"==typeof global&&this===global?global:this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var i,o=Object.prototype.toString,a=Array.isArray||function(n){return"[object Array]"===o.call(n)},c=function(n,t){for(var e=-1,r=n.length;++e<r;)t(n[e],e,n)},f=function(n,t){for(var e=-1,r=n.length,u=Array(r);++e<r;)u[e]=t(n[e],e,n);return u},l=function(n,t,e){return c(n,function(n,r,u){e=t(e,n,r,u)}),e},s=function(n,t){c(p(n),function(e){t(n[e],e)})},p=Object.keys||function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},d=function(n,t){t=t||0;var e=-1,r=n.length;t&&(r-=t,r=0>r?0:r);for(var u=Array(r);++e<r;)u[e]=n[e+t];return u};"function"==typeof setImmediate&&(i=setImmediate),"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate=i?function(n){i(n)}:r.nextTick):i?(r.nextTick=function(n){i(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){function i(n){n?(r(n),r=u):(o+=1,o>=t.length&&r())}if(r=r||u,!t.length)return r();var o=0;c(t,function(t){e(t,n(i))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||u,!n.length)return e();var r=0,i=function(){t(n[r],function(t){t?(e(t),e=u):(r+=1,r>=n.length?e():i())})};i()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=v(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var v=function(n){return function(t,e,r){if(r=r||u,!t.length||0>=n)return r();var i=0,o=0,a=0;!function c(){if(i>=t.length)return r();for(;n>a&&o<t.length;)o+=1,a+=1,e(t[o-1],function(n){n?(r(n),r=u):(i+=1,a-=1,i>=t.length?r():c())})}()}};r.forEachOf=r.eachOf=function(n,t,e){e=e||function(){};var r=n.length||p(n).length,u=0;return r?void s(n,function(i,o){t(n[o],o,function(n){n?(e(n),e=function(){}):(u+=1,u===r&&e(null))})}):e()},r.forEachOfSeries=r.eachOfSeries=function(n,t,e){e=e||function(){};var u=p(n),i=u.length;if(!i)return e();var o=0,a=function(){var c=!0,f=u[o];t(n[f],f,function(n){n?(e(n),e=function(){}):(o+=1,o>=i?e(null):c?r.nextTick(a):a())}),c=!1};a()},r.forEachOfLimit=r.eachOfLimit=function(n,t,e,r){h(t)(n,e,r)};var h=function(n){return function(t,e,r){r=r||function(){};var u=p(t),i=u.length;if(!i||0>=n)return r();var o=0,a=0,c=0;!function f(){if(o>=i)return r();for(;n>c&&i>a;){a+=1,c+=1;var l=u[a-1];e(t[l],l,function(n){n?(r(n),r=function(){}):(o+=1,c-=1,o>=i?r():f())})}}()}},m=function(n){return function(){var t=d(arguments);return n.apply(null,[r.each].concat(t))}},g=function(n,t){return function(){var e=d(arguments);return t.apply(null,[v(n)].concat(e))}},y=function(n){return function(){var t=d(arguments);return n.apply(null,[r.eachSeries].concat(t))}},k=function(n,t,e,r){if(t=f(t,function(n,t){return{index:t,value:n}}),r){var u=[];n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})}else n(t,function(n,t){e(n.value,function(n){t(n)})})};r.map=m(k),r.mapSeries=y(k),r.mapLimit=function(n,t,e,r){return x(t)(n,e,r)};var x=function(n){return g(n,k)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var i=f(n,function(n){return n}).reverse();r.reduce(i,t,e,u)},r.foldr=r.reduceRight;var w=function(n,t,e,r){var u=[];t=f(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(){r(f(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=m(w),r.filterSeries=y(w),r.select=r.filter,r.selectSeries=r.filterSeries;var b=function(n,t,e,r){var u=[];t=f(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(){r(f(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=m(b),r.rejectSeries=y(b);var S=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=u):t()})},function(){r()})};r.detect=m(S),r.detectSeries=y(S),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=u),r()})},function(){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=u),r()})},function(){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,f(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||u;var e=p(n),i=e.length;if(!i)return t();var o={},f=[],s=function(n){f.unshift(n)},v=function(n){for(var t=0;t<f.length;t+=1)if(f[t]===n)return void f.splice(t,1)},h=function(){i--,c(f.slice(0),function(n){n()})};s(function(){if(!i){var n=t;t=u,n(null,o)}}),c(e,function(e){for(var i,f=a(n[e])?n[e]:[n[e]],m=function(n){var i=d(arguments,1);if(i.length<=1&&(i=i[0]),n){var a={};c(p(o),function(n){a[n]=o[n]}),a[e]=i,t(n,a),t=u}else o[e]=i,r.setImmediate(h)},g=f.slice(0,Math.abs(f.length-1))||[],y=g.length;y--;){if(!(i=n[g[y]]))throw new Error("Has inexistant dependency");if(a(i)&&~i.indexOf(e))throw new Error("Has cyclic dependencies")}var k=function(){return l(g,function(n,t){return n&&o.hasOwnProperty(t)},!0)&&!o.hasOwnProperty(e)};if(k())f[f.length-1](m,o);else{var x=function(){k()&&(v(x),f[f.length-1](m,o))};s(x)}})},r.retry=function(n,t,e){var u=5,i=[];"function"==typeof n&&(e=t,t=n,n=u),n=parseInt(n,10)||u;var o=function(u,o){for(var a=function(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},o)}};n;)i.push(a(t,!(n-=1)));r.series(i,function(n,t){t=t[t.length-1],(u||e)(t.err,t.result)})};return e?o():o},r.waterfall=function(n,t){if(t=t||u,!a(n)){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var i=function(n){return function(e){if(e)t.apply(null,arguments),t=u;else{var o=d(arguments,1),a=n.next();o.push(a?i(a):t),r.setImmediate(function(){n.apply(null,o)})}}};i(r.iterator(n))()};var I=function(n,t,e){if(e=e||u,a(t))n.map(t,function(n,t){n&&n(function(n){var e=d(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(p(t),function(n,e){t[n](function(t){var u=d(arguments,1);u.length<=1&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){I({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){I({map:x(t),each:v(t)},n,e)},r.series=function(n,t){if(t=t||u,a(n))r.mapSeries(n,function(n,t){n&&n(function(n){var e=d(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(p(n),function(t,r){n[t](function(n){var u=d(arguments,1);u.length<=1&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=d(arguments,1);return function(){return n.apply(null,t.concat(d(arguments)))}};var E=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=m(E),r.concatSeries=y(E),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(u){if(u)return e(u);var i=d(arguments,1);t.apply(null,i)?r.doWhilst(n,t,e):e()})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(u){if(u)return e(u);var i=d(arguments,1);t.apply(null,i)?e():r.doUntil(n,t,e)})},r.queue=function(t,e){function u(n,t,e,u){return n.started||(n.started=!0),a(t)||(t=[t]),0===t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var i={data:t,callback:"function"==typeof u?u:null};e?n.tasks.unshift(i):n.tasks.push(i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}if(void 0===e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,t){u(o,n,!1,t)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(n,t){u(o,n,!0,t)},process:function(){if(!o.paused&&i<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),i+=1;var r=function(){i-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+i===0&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return i},idle:function(){return o.tasks.length+i===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var n=Math.min(o.concurrency,o.tasks.length),t=1;n>=t;t++)r.setImmediate(o.process)}}};return o},r.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function u(n,t,e){for(var r=-1,u=n.length-1;u>r;){var i=r+(u-r+1>>>1);e(t,n[i])>=0?r=i:u=i-1}return r}function i(n,t,i,o){return n.started||(n.started=!0),a(t)||(t=[t]),0===t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var a={data:t,priority:i,callback:"function"==typeof o?o:null};n.tasks.splice(u(n.tasks,a,e)+1,0,a),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var o=r.queue(n,t);return o.push=function(n,t,e){i(o,n,t,e)},delete o.unshift,o},r.cargo=function(n,t){var e=!1,u=[],i={tasks:u,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(n,e){a(n)||(n=[n]),c(n,function(n){u.push({data:n,callback:"function"==typeof e?e:null}),i.drained=!1,i.saturated&&u.length===t&&i.saturated()}),r.setImmediate(i.process)},process:function o(){if(!e){if(0===u.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var r="number"==typeof t?u.splice(0,t):u.splice(0,u.length),a=f(r,function(n){return n.data});i.empty&&i.empty(),e=!0,n(a,function(){e=!1;var n=arguments;c(r,function(t){t.callback&&t.callback.apply(null,n)}),o()})}},length:function(){return u.length},running:function(){return e}};return i};var O=function(n){return function(t){var e=d(arguments,1);t.apply(null,e.concat([function(t){var e=d(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))}]))}};r.log=O("log"),r.dir=O("dir"),r.memoize=function(n,t){var e={},u={};t=t||function(n){return n};var i=function(){var i=d(arguments),o=i.pop(),a=t.apply(null,i);a in e?r.nextTick(function(){o.apply(null,e[a])}):a in u?u[a].push(o):(u[a]=[o],n.apply(null,i.concat([function(){e[a]=d(arguments);var n=u[a];delete u[a];for(var t=0,r=n.length;r>t;t++)n[t].apply(null,arguments)}])))};return i.memo=e,i.unmemoized=n,i},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.seq=function(){var n=arguments;return function(){var t=this,e=d(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=d(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var T=function(n,t){var e=function(){var e=this,r=d(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=d(arguments,2);return e.apply(this,r)}return e};r.applyEach=m(T),r.applyEachSeries=y(T),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):t.async=r}();
